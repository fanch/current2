<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
     <link rel="shortcut icon" href="../favicon.ico">
     <link rel="stylesheet" href="../css/nutyx.css" />
     <title>NuTyX - Comment construire un paquet ?</title>
 </head>
 <body>
    <table>
     <tr>
      <td>
            <a href=".."><img id="logo" src="../graphics/logo_nutyx_120.png" alt="logo nutyx" /></a>
      </td>
      <td>
       <nav>
        <ul>
            <li><a href=".">Accueil</a></li>
            <li><a href="information.html">Information</a></li>
            <li><a href="documentation.html">Documentation</a></li>
            <li><a href="installation.html">Installation</a></li>
            <li><a href="faq.html">FAQ</a></li>
            <li><a href="packages.html">Paquets</a></li>
            <li><a href="http://forum.nutyx.org/index.php?action=recent">Forum</a></li>
            <li><a href="http://github.com/NuTyX">Code</a></li>
        </ul>
       </nav>
      </td>
     </tr>
    </table>
 <hr>
 <h1>Comment construire un paquet ?</h1>
  <h2>Introduction</h2>
   <p>Nous connaissons les <a href="why-contribute.html">raisons de contribuer</a>, <a href="bash-basics.html">les connaissances requises</a>, <a href="base-commands.html">les commandes de base à notre disposition</a>, le <a href="recept.html">format minimum d'une recette</a> et enfin quelles sont <a href="packages.html">les recettes existantes</a>. Il est temps de passer à l'action et de construire son premier paquet dans les règles de l'art (de NuTyX) <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" />.</p>
   <p>Si vous êtes sur une version de cards plus ancienne que la version <b>1.3</b>, il est temps de mettre à jour votre gestionnaire de paquets</p>
  <h2>Sommaire</h2>
    <h3>
     <a href="#1">Petit lexique du NuTyXien</a><br />
     <a href="#2">Quel scénario choisissez-vous ?</a><br />
     <a href="#3">Ajuster les fichiers de configuration en fonction de votre scénario</a><br />
     <a href="#4">Scénario B: un paquet sans dépendance</a><br />
     <a href="#5">Scénario C: Un paquet avec quelques dépendances</a><br />
     <a href="#6">Scénario E: construction dans un environnement isolé aussi appelé "chroot"</a><br />
    </h3>
  <a name='1'></a>
   <h2>Petit lexique du NuTyXien</h2>
    <h3>Un script</h3>
     <p>Le script est utilisé, comme en cinéma, pour définir chaque action devant être exécutée par l'interpréteur. Dans le cadre de cet article, le script sera donc l'ensemble des actions ordonnées à faire pour la construction d'un paquet</p>
    <h3>Une collection</h3>
     <p>Une collection regroupe tous les paquets qui constituent un ensemble de fonctionnalitées. La collection <b>gui</b> par exemple permet d'avoir une inteface utilisateur graphique. Sur cette interface graphique, on choisira son gestionnaire de fenêtres favori. Sous NuTyX, il est possible d'installer les collections <b>kde5</b>, <b>gnome</b>, <b>xfce4</b>, <b>lxde</b>, etc</p>
    <h3>Un groupe</h3>
     <p>Sous NuTyX, un groupe de paquets désigne un ensemble de paquets dont le commencement du nom est commun: Un exemple de groupe de paquets sous NuTyX:</p>
      <li>gstreamer1</li>
      <li> gstreamer1-plugins-bad</li>
      <li>gstreamer1-plugin-good</li>
      <li>gstreamer1-plugin-libav</li>
      <li>gstreamer1-...</li> 
    <h3>Une catégorie</h3>
     <p>Une catégorie définie un ensemble d'applications ayant des fonctionnalitées similaires: Un exemple typique de catégorie est "Internet" qui regroupera les navigateurs, les client d'email, clients discussions instantanées, etc</p>
    <h3>Une recette</h3>
     <p>Une recette définie la construction d'un <b>paquet</b>. Sous NuTyX, la recette d'un <b>paquet</b> se trouve dans le fichier <b>Pkgfile</b>. Le contenu de ce fichier suit un schéma standard et est composé de trois parties:</p>
     <ol>
      <li>Les informations générales (optionnelles mais vivement recommandées) sur le paquet: Description, URL, Developeur(s), Empaqueteu(r), dépendances</li>
      <li>Les informations indispensable pour la construction du paquet: Nom, version, release</li>
      <li>La fonction "build" définit la construction proprement dite du paquet</li>
     </ol>
    <h3>Un port</h3>
     <p>Sur NuTyX, un port est constitué d'un dossier contenant toujours au minimum un fichier appelé <b>Pkgfile</b>. Le <b>Pkgfile</b> contient la recette de construction de l'application. Le résultat de la construction sera un <b>paquet</b> qui pourra être installé par le gestionnaire de paquets <b>cards</b></p>
    <h3>Un paquet</h3>
     <p>Un paquet est une archive contenant un ensemble de fichiers. Ces fichiers peuvent être de différente nature. On y trouvera des librairies, des applications en ligne de commande, des application utilisées dans un environnement graphique, des information de configuratio, etc</p>
    <h3>Un scénario</h3>
     <p>Qu'est-ce qu'un scénario <img src="../graphics/confused.gif" alt="" /> dans le contexte d'une distribution linux ?</p>
     <p>Ne demandez pas (encore) à google, je ne crois pas que ce concept existe déjà sur d'autres distributions <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" /> <p>
     <p>C'est un concept que j'ai imaginé en créant le gestionnaire de paquets <b>cards</b>.</p>
     <p>Au fil des années, je me suis rendu compte que le public cible pour l'utilisation d'une distribution comme NuTyX était très très large. Chaque utilisateur (plus ou moins averti) souhaite évoluer sur sa distribution à sa manière.</p>
     <p>La plupart des utilisateurs se dirigeant vers NuTyX souhaitent compiler leurs paquets à leur guise. Certains ne choisiront peut-être pas toutes les collections proposées par défaut. D'autres utilisateurs souhaiteront mélanger les paquets standards proposés en binaire avec leur propres paquets. Toutes ces approches sont différentes, je les appelle <b>scénarios</b> d'utilisation de la NuTyX.</p>
    <h3>Une chroot</h3>
     <p>Une chroot permet d'isoler l'environnement de travail dans lequel on pourra construire toutes les recettes provenant des différents ports.</p>
     <p>Une chroot se justifie surtout pour s'assurer qu'aucune dépendances ne soient installées depuis le système d'exploitation "père"
  <a name='2'></a>
  <h2>Quel scénario choisissez-vous ?</h2>
   <h3>Quels sont les scénarios possibles (cad ce que je peux imaginer aujourd'hui)</h3>
    <ol>
     <li><a href="#21">Scénario <b>A</b></a>: Je ne veux rien compiler, les binaires disponibles me suffisent<img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" />. Cela peut vous paraître absurde d'en parler ici, mais comme vous êtes très interessés par le sujet, sachez que ce scénario vous permet de garder votre distribution favorite la plus légère possible.</li>
     <li><a href="#22">Scénario <b>B</b></a>: Les binaires disponibles ne me suffisent pas, je voudrais ajouter un ou deux paquets.</li>
     <li><a href="#23">Scénario <b>C</b></a>: Je ne souhaite pas installer les binaires des collections <b>cli</b>, <b>cli-extra</b>, <b>gui</b> et <b>gui-extra</b>. Je les compile moi-même. </li>
     <li><a href="#24">Scénario <b>D</b></a>: Je souhaite utiliser les binaires disponibles des collections <b>cli</b>, <b>cli-extra</b>, <b>gui</b> et <b>gui-extra</b>. Je souhaite que mes ports personnels utilisent les dépendances provenant des binaires déjà disponibles. Seul mes ports personnels doivent être compilés.</li>
     <li><a href="#25">Scénario <b>E</b></a>: Je souhaite construire mes recettes dans un environnement isolé et garder ma distribution intacte et vierge de tout paquets de développement. Mes paquets produits dans mon environnement isolé pourront être installés dans ma NuTyX principale.</li>
    </ol>
  <a name='2'></a>
  <h2>Ajuster les fichiers de configuration en fonction de votre scénario</h2>
   <h3>Introduction</h3>
    <p>Voyons en détail chaque scénario mentionné plus haut et comment ajuster le mieux les fichiers de configuration pour chacun d'entre eux.</p>
   <a name='21'></a>
   <h3>Scénario A</h3>
    <a name='211'></a>
    <h4>Introduction</h4>
     <p>Comme expliqué plus haut, vous ne souhaitez pas compiler dans votre NuTyX. Ce qui est tout à fait possible si vous n'avez pas besoin de programmes particuliers et que les binaires proposés vous suffisent. Ce scenario est aussi valable dans le cas où vous gérer plusieurs installations sur les quelles aucune compilation n'est necessaire.</p>
    <a name='212'></a>
    <h4>Le fichier /etc/cards.conf</h4>
     <p>Les collections binaires sont activées</p>
     <p>La(les) langue(s) utilisée(s) sur la machine est ajustée(s)</p>
     <p>Les dossiers définissant le système de base, en cas de retour à un système de base sont définis</p>
     <p>Le contenu typique de votre fichier <b>/etc/cards.conf</b>:</p>
     <pre class="output">dir /var/lib/pkg/depotrepo/xfce4-extra|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/xfce4|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/gui|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/gui-extra|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/cli|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/cli-extra|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/base|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/base-extra|http://downloads.nutyx.org
locale fr
locale de
base /var/lib/pkg/depotrepo/base
base /var/lib/pkg/depotrepo/base-extra</pre>
     <p>Les six collections standards <b>base</b>, <b>cli</b> et <b>gui</b> sont activées, ainsi que les collections <b>xfce4</b>. Les langues qui doivent être installées sont le français <b>fr</b> et l'allemand <b>de</b>. Les dossiers contenant les paquets de base snt ceux des collections standard <b>base</b> et <b>base-extra</b>.</p>
     <pre class="output">base /var/lib/pkg/depotrepo/base
base /var/lib/pkg/depotrepo/base-extra</b></pre>
    <a name='213'></a>
    <h4>Le fichier /etc/pkgmk.conf</h4>
     <p>Pour le scénario <b>A</b>, le fichier <b>/etc/pkgmk.conf</b> n'est pas présent puisque vous ne devez rien compiler. Les outils de développement ne sont pas présents.</p>
    <a name='214'></a>
    <h4>Conclusion</h4>
     <p>C'est tout ce qu'il faut savoir pour la configuration de votre NuTyX. Vous souhaitez mettre à jour votre base de données et voir si il y a des maj disponibles</p>
     <pre class="command"><kbd>check</kbd></pre>
     <p>Vous souhaitez installer un paquet:</p>
     <pre class="command"><kbd>get firefox</kbd></pre>
     <p>Vous souhaitez supprimer un paquet:</p>
     <pre class="command"><kbd>del firefox</kbd></pre>
     <p>C'est tout ce qu'il faut savoir <img src="../graphics/smiley-tongue-out.gif" alt="Tongue out" title="Tongue out" />. J'espère que vous allez vous en sortir.</p>
    <a name='22'></a>
    <h3>Scénario B</h3>
     <a name='221'></a>
     <h4>Introduction</h4>
      <p>Vous êtes satisfait de votre NuTyX, il y a juste un ou deux paquets qui vous manquent, vous décidez donc de les compilez vous-même.</p>
      <p>Armez-vous de courage et de patience <img src="../graphics/smiley-tongue-out.gif" alt="Tongue out" title="Tongue out" /><img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" />.</p>
      <div class="important"><img alt="[Important]" src="../graphics/caution.gif" />Dans ce scénario, évitez à tout prix de compiler des recettes réclamant des dépendances. Si tel est le cas, vous serez confrontez aux nombreuses erreurs liées aux dépendances devel non installées par défaut. Dans un tel cas, préférez le scenario <b>C</b>. Vous voilà averti</div>
     <a name='222'></a>
     <h4>Le fichier /etc/cards.conf</h4>
      <p>Un dossier contenant mes recettes personnelles est ajouté, ce dossier ne <u>doit jamais</u> être mis à jour par la commande <b>cards sync</b>, donc on ne doit pas spécifier d'adresse URL associées.</p>
      <p>Les collections binaires sont activées, cela me permettra d'ajouter facilement les éventuelles dépendances manquantes...</p>
      <p>La(les) langue(s) utilisée(s) sur la machine est ajustée(s)</p>
      <p>Le dossier définissant le système de base, en cas de retour à un système de base est défini</p>
      <p>Le contenu typique de votre fichier <b>/etc/cards.conf</b> pour le scénario <b>B</b>:</p>
      <pre class="output">
dir /usr/ports/personnel
dir /var/lib/pkg/depotrepo/gui|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/cli|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/base|http://downloads.nutyx.org
locale fr
locale de
base /var/lib/pkg/depotrepo/base
base /var/lib/pkg/depotrepo/base-extra</pre>
     <a name='223'></a>
     <h4>Installation des outils de développement</h4>
      <p>On peut maintenant commencer par installer les paquets de développement, cad un compilateur, les librairies C et C++ les outils autoconf, automake, etc etc.. Commençons par créer le dossier <b>/usr/ports/personnel</b>.</p>
      <pre class="command_user"><kbd>sudo mkdir -p /usr/ports/personnel</kbd></pre>
      <p>Et maintenant on installe les outils:</p>
      <pre class="command_user"><kbd>sudo cards sync</kbd></pre>
      <pre class="output">/var/lib/pkg/depotrepo/gui/.PKGREPO
/var/lib/pkg/depotrepo/cli/.PKGREPO
/var/lib/pkg/depotrepo/base/.PKGREPO</pre>
      <pre class="command_user"><kbd>sudo cards install cards.devel</kbd></pre>
      <pre class="output">Retrieve info about the 66 packages: 100 %
/var/lib/pkg/depotrepo/base/cards/.PKGREPO
/var/lib/pkg/depotrepo/base/cards/cards.devel1429192050x86_64.cards.tar.xz
661020 Bytes - 671821 Bytes/Sec - 100% - 0 Sec remain  remain 
/var/lib/pkg/depotrepo/base/acl/.PKGREPO
/var/lib/pkg/depotrepo/base/acl/acl.devel1412540285x86_64.cards.tar.xz
...</pre>
     <a name='224'></a>
     <h4>Le fichier /etc/pkgmk.conf</h4>
      <p>Avant de construire son premier paquet, il est bon de vérifier quelques variables définies dans le fichier de configuration <b>/etc/pkgmk.conf</b>:</p>
      <p>Mon processeur est un 8 coeurs, donc autant en profiter:</p>
      <pre class="output">export MAKEFLAGS="-j8"</pre>
      <p>Les sources sont sauvegardées dans le dossier contenant la recette ou dans un autre dossier. Personnellement, je préfère les mettre ensemble dans un dossier séparé commun. Et pourquoi pas un dossier qui sera nettoyé au prochain boot, je choisi le dossier <b>/tmp</b>. Je souhaite que les sources soient effacées une fois le paquet compilé et installé avec succès. Et enfin, je préfère que le dossier de travail soit également sous le dossier <b>/tmp/work</b> en lieu du dossier défini par défaut:</p>
      <pre class="output">PKGMK_SOURCE_DIR="/tmp"
PKGMK_KEEP_SOURCES="no"
PKGMK_WORK_DIR="/tmp/work"</pre>
      <p>Je n'ai pas envie de spécifier à chaque fois la demande de téléchargement des sources si pas disponible. Une variable permet de le faire automatiquement:</p>
      <pre class="output">PKGMK_DOWNLOAD="yes"</pre>
      <p>Dans ce scénario, je ne souhaite pas gérer les dépendances de façon automatique lors de la compilation et donc je n'ai pas besoin du fichier <b>.PKGREPO</b>... Je n'utilise que la commande <b>pkgmk</b>:</p>
      <pre class="output">PKGMK_IGNORE_REPO="yes"
PKGMK_IGNORE_COLLECTION="yes"</pre>
      <p>Je ne souhaite pas que <b>pkgmk</b> split le binaire en paquet et sous paquets (devel, doc, man, etc). Je me contente du paquet de base puisque je le compile moi-même. Pour les locales, si elles existent, je me contenterai des locale françaises et allemandes <b>fr</b> et <b>de</b>:
      <pre class="output">PKGMK_GROUPS=()
PKGMK_LOCALES=(fr de)</pre>
      <p>Pour gagner du temps, je ne souhaite pas que <b>pkgmk</b> compresse mon paquet une fois construit et pour gagner de la place, je ne souhaite pas le conserver une fois installé:</p>
      <pre class="output">PKGMK_COMPRESSION_PACKAGE="no"
PKGMK_CLEAN="yes"</pre>
      <p>Voici à quoi peut ressembler votre fichier <b>/etc/pkgmk.conf</b> pour le scénario <b>B</b>:</p>
      <pre class="output">export CFLAGS="-O2 -pipe"
export CXXFLAGS="${CFLAGS}"
case ${PKGMK_ARCH} in
    "x86_64"|"")
       export MAKEFLAGS="-j8"
       ;;
    "i686")
       export CFLAGS="${CFLAGS} -m32"
       export CXXFLAGS="${CXXFLAGS} -m32"
       export LDFLAGS="${LDFLAGS} -m32"
       ;;
    *)
       echo "Unknown architecture selected! Exiting."
       exit 1
       ;;
esac
PKGMK_DOWNLOAD="yes"
PKGMK_SOURCE_DIR="/tmp"
PKGMK_KEEP_SOURCES="no"
PKGMK_WORK_DIR="/tmp/work"
PKGMK_IGNORE_REPO="yes"
PKGMK_IGNORE_COLLECTION="yes"
PKGMK_GROUPS=()
PKGMK_LOCALES=(fr de)
PKGMK_COMPRESSION_PACKAGE="no"
PKGMK_CLEAN="yes"</pre>
      <p>Voilà pour ce qui est de la configuration du fichier <b>/etc/pkgmk.conf</b>
     <a name='225'></a>
     <h4>Conclusion</h4>
      <p><a href="#4">On verra plus tard avec un exemple de paquet, comment créer, compiler et installer un paquet</a> <u>sans dépendances</u> ou dont les dépendances sont déjà installées. Pour ce scénario, la seule commande à retenir est:</p>
      <pre class="command"><kbd>pkgmk
pkgadd</kbd></pre>
      <p>Cette commande sera <u>toujours</u> lancée dans le dossier de la recette.</p>
    <a name='23'></a>
    <h3>Scénario C</h3>
     <a name='231'></a>
     <h4>Introduction</h4>
      <p>Vous avez des envies de compilation à grande échelle, vous êtes convaincu que c'est le meilleur scénario pour gérer une NuTyX. Vous n'avez aucune envie d'utiliser les binaires proposés.</p>
      <p>La plus part des paquets que vous utilisez ne sont pas présents et ceux qui le sont, seront compilés par vous-même.</p>
      <p>Vous souhaitez obtenir les maj des ports disponibles.</p>
      <p> Et bien évidement, vous souhaitez que les dépendances soient compilées automatiquement.</p>
      <p> Vous l'avez compris, ce scenario est sans doute le plus "attirant" et le plus proche des distributions "dite" sources telle que CRUX ou gentoo.</p>
     <a name='232'></a>
     <h4>Le fichier /etc/cards.conf</h4>
      <p>Un dossier contenant mes recettes personnelles est ajouté, ce dossier ainsi que les collections ne <u>doivent jamais</u> être mis à jour par la commande <b>cards sync</b>, donc on ne spécifie aucune adresse URL.</p>
      <p>Seule la collection <b>base</b> doit rester active afin de pouvoir installer les outils de développement.</p>
      <p>Mon processeur est un 4 coeurs, donc autant en profiter:</p>
      <p>Le dossier contenant les logs de compilation est défini</p>
      <p>Les dossiers définissant le système de base, en cas de retour à un système de base sont définis</p>
      <p>Le contenu typique de votre fichier <b>/etc/cards.conf</b> pour le scénario <b>C</b>:</p>
      <pre class="output">dir /usr/ports/personnel
dir /usr/ports/gui
dir /usr/ports/cli
dir /usr/ports/base
dir /var/lib/pkg/depotrepo/base|http://downloads.nutyx.org
logdir /var/log/pkgbuild
locale fr
locale it
base /usr/ports/base
base /usr/ports/base-extra
base /usr/ports/aconserver</pre>
     <a name='233'></a>
     <h4>Installation des outils de développement</h4>
      <p>On peut maintenant commencer par installer les paquets de développement, cad un compilateur, les librairies C et C++ les outils autoconf, automake, etc etc.. . On commence par créer les dossiers necessaires:</p>
      <pre class="command_user"><kbd>sudo mkdir -p /usr/ports/{personnel,gnome,aconserver}
sudo mkdir -p /srv/www/sources</kbd></pre>
      <p>Et maintenant on installe les outils</p>
      <pre class="command_user"><kbd>sudo cards sync</kbd></pre>
      <pre class="output">/var/lib/pkg/depotrepo/base/.PKGREPO</pre>
      <pre class="command_user"><kbd>sudo cards install cards.devel rsync git</kbd></pre>
      <pre class="output">Retrieve info about the 66 packages: 100 %
/var/lib/pkg/depotrepo/base/cards/.PKGREPO
/var/lib/pkg/depotrepo/base/cards/cards.devel1429192050x86_64.cards.tar.xz
661020 Bytes - 671821 Bytes/Sec - 100% - 0 Sec remain  remain 
/var/lib/pkg/depotrepo/base/acl/.PKGREPO
/var/lib/pkg/depotrepo/base/acl/acl.devel1412540285x86_64.cards.tar.xz
...</pre>
     <a name='234'></a>
     <h4>Le fichier /etc/pkgmk.conf</h4>
      <p>Pour ce scénario, il est indispensable de vérifier toutes les variables necessaires pour le bon fonctionnement du duo <b>pkgmk/cards</b></p>
      <pre class="output">export MAKEFLAGS="-j4"</pre>
      <p>Les sources sont stockées dans un dossier commun, je ne souhaite pas qu'elles soient effacées. Je souhaite que le dossier de travail reste dans le dossier du port, cela me permettra eventuellement de compiler plusieurs ports sans perdre le travail. C'est très utile pour vérifier.</p>
      <pre class="output">PKGMK_SOURCE_DIR="/srv/www/sources"
PKGMK_KEEP_SOURCES="yes"
PKGMK_WORK_DIR="$PWD/work"</pre>
      <p>Dans ce scénario, je souhaite gérer les dépendances de façon automatique lors de la compilation et donc j'ai besoin du fichier <b>.PKGREPO</b> généré dans le dossier du port. Je souhaite pouvoir utiliser la commande <b>cards install</b> ou <b>get</b> pour pouvoir réinstaller mes binaires disponibles.  La commande <b>pkgmk</b> doit donc générer le <b>.PKGREPO</b> de la collection concernée (dossier parent). Je utilise le duo <b>cards/pkgmk</b>:</p>
      <pre class="output">PKGMK_IGNORE_REPO="no"
PKGMK_IGNORE_COLLECTION="no"</pre>
      <p>Je ne souhaite pas que <b>pkgmk</b> split le binaire en paquet et sous paquets (devel, doc, man, etc). Je me contente du paquet de base puisque je le compile moi-même. Pour les locales, si elles existent, je me contenterai des locale françaises et italiennes <b>fr</b> et <b>it</b>:
      <pre class="output">PKGMK_GROUPS=()
PKGMK_LOCALES=(fr it)</pre>
      <p>Je souhaite que <b>pkgmk</b> compresse mon paquet au format gz (parce que l'algo  est beaucoup plus rapide qu'en xz ) une fois construit et qu'il soit conservé une fois installé pour usage ultérieur. Par exemple si je souhaite revenir à un système de base via la commande <b>cards base</b>:</p>
      <pre class="output">PKGMK_COMPRESSION_PACKAGE="yes"
PKGMK_COMPRESSION_MODE="gz"
PKGMK_CLEAN="no"</pre>
      <p>Voici à quoi peut ressembler votre fichier <b>/etc/pkgmk.conf</b> pour le scénario <b>C</b>:</p>
      <pre class="output">export CFLAGS="-O2 -pipe"
export CXXFLAGS="${CFLAGS}"
case ${PKGMK_ARCH} in
    "x86_64"|"")
       export MAKEFLAGS="-j4"
       ;;
    "i686")
       export CFLAGS="${CFLAGS} -m32"
       export CXXFLAGS="${CXXFLAGS} -m32"
       export LDFLAGS="${LDFLAGS} -m32"
       export MAKEFLAGS="-j4"
       ;;
    *)
       echo "Unknown architecture selected! Exiting."
       exit 1
       ;;
esac
PKGMK_SOURCE_DIR="/srv/www/sources"
PKGMK_KEEP_SOURCES="yes"
PKGMK_WORK_DIR="$PWD/work"
PKGMK_IGNORE_REPO="no"
PKGMK_IGNORE_COLLECTION="no"
PKGMK_GROUPS=()
PKGMK_LOCALES=(fr it)
PKGMK_COMPRESSION_PACKAGE="yes"
PKGMK_COMPRESSION_MODE="gz"
PKGMK_CLEAN="no"</pre>
     <a name='235'></a>
     <h4>Conclusion</h4>
      <p>On peut maintenant récupérer les ports disponibles de NuTyX:</p>
      <pre class="command_user"><kbd>cd /usr/ports
git clone git://github.com/NuTyX/houaphan.git</kbd></pre>
      <p><a href="#5">On verra plus tard avec une exemple, comment créer, compiler et installer une ensemble de paquets</a>. Pour ce scénario, les commandes à retenir sont:</p>
      <pre class="command"><kbd>cards depends
cards depcreate
cards level</kbd></pre>
      <p>Pour connaître en détail la fonctionnalitée de ces commandes, je vous invite à lire le man de cards:</p>
      <pre class="command"><kbd>man cards</kbd></pre>
    <a name='24'></a>
    <h3>Scénario D</h3>
     <a name='241'></a>
     <h4>Introduction</h4>
      <p>Vous n'avez pas envie de vouloir tout compiler, vous êtes satisfait avec les binaires disponibles. Vos nouvelles recettes utilisent les dépendances provenant des binaires existants. Ce scénario est probablement le plus long à mettre en oeuvre mais une fois tout en place, l'ajout de paquets personnels se fait très rapidement.</p>
      <p>Vous trouverez une version de ce scénario plus condensée sur <a href="https://github.com/NuTyX">la page github de NuTyX</a>. Il faut noter sur le site, les explications se basent sur <a href="#6">l'utilisation d'une chroot</a>. A vous de choisir la collection qui vous intéresse.</p>
     <a name='242'></a>
     <h4>Le fichier /etc/cards.conf</h4>
      <p>Un dossier contenant mes recettes personnelles est ajouté, ce dossier ainsi que les collections ne <u>doivent jamais</u> être mis à jour par la commande <b>cards sync</b>. On ne spécifie donc aucune URL.</p>
      <p>Seule la collection <b>base-extra</b> doit rester active le temps de récupérer la commande <b>rsync</b> si pas encore installée.</p>
      <p>Le dossier contenant les logs de compilation est défini</p>
      <p>Je n'ai pas besoin de spécifier les locales, elles seront toujours toutes installées</p>
      <p>Les dossiers définissant le système de base, en cas de retour à un système de base sont définis</p>
      <p>Le contenu typique de votre fichier <b>/etc/cards.conf</b> pour le scénario <b>D</b>:</p>
      <pre class="output">dir /srv/www/houaphan/x86_64/personnel
dir /srv/www/houaphan/x86_64/gui
dir /srv/www/houaphan/x86_64/cli
dir /srv/www/houaphan/x86_64/base
dir /var/lib/pkg/depotrepo/base-extra|http://downloads.nutyx.org
logdir /var/log/pkgbuild
base /srv/www/houaphan/x86_64/base
base /srv/www/houaphan/x86_64/base-extra
base /srv/www/houaphan/x86_64/aconserver</pre>
     <a name='243'></a>
     <h4>Installation de rsync et suppression du dossier concerné</h4>
      <p>Pour ce scénario, nous allons synchroniser tous les binaires disponibles sur le miroir de NuTyX et allons restés "callés" sur la version de ceux-ci.</p>
      <p>Commençons par installer la commande <b>rsync</b> si ce n'est pas encore le cas:</p>
      <pre class="command_user"><kbd>get rsync</kbd></pre>
      <p>On peut maintenant supprimer la ligne pointant sur l'url du miroir de NuTyX pour déactiver définitivement la commande <b>cards sync</b>.</p>
      <p>Le nouveau fichier <b>/etc/cards.conf</b>:</p>
      <pre class="output">dir /srv/www/houaphan/personnel
dir /srv/www/houaphan/x86_64/gui
dir /srv/www/houaphan/x86_64/cli
dir /srv/www/houaphan/x86_64/base
dir /srv/www/houaphan/x86_64/base-extra
logdir /var/log/pkgbuild
base /srv/www/houaphan/x86_64/base
base /srv/www/houaphan/x86_64/base-extra
base /srv/www/houaphan/aconserver</pre>
     <a name='244'></a>
     <h4>Synchronisation des binaires via rsync</h4>
      <p>Cette opération consiste à rapatrier les quelques 1100 paquets disponibles en binaires. Elle peut durer entre quelques minutes et quelques heures en fonction de votre connection.</p>
      <p>Heureusement, cette opération n'est longue que la première fois <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" /> <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" /> <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" />.</p>
      <p>Notez bien le dossier de destination, j'ai choisi de "déposer" les binaires à la racine du serveur http <img src="../graphics/smiley-tongue-out.gif" alt="Tongue out" title="Tongue out" />. </p>
      <p>Il faut commencer par créer les dossiers</p>
      <pre class="command_user"><kbd>sudo mkdir -p /srv/www/houaphan/x86_64/{personnel,aconserver}</kbd></pre>
      <p>On peut maintenant synchroniser l'ensemble des binaires:</p>
      <pre class="command_user"><kbd>for i in base cli gui; do sudo rsync -avz --delete-after rsync://downloads.nutyx.org/nutyx/8.0/x86_64/$i \
/srv/www/houaphan/x86_64/$i;done</kbd></pre>
      <p>Allez peut-être boire un café, manger une pizza ou un bon paquet de frites <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" />, ça peut-être long...</p>
     <a name='245'></a>
     <h4>Le fichier /etc/pkgmk.conf</h4>
      <p>Pour ce scénario, il est indispensable de vérifier toutes les variables necessaires pour le bon fonctionnement du duo <b>pkgmk/cards</b>.</p>
      <p>Mon processeur est un double coeur et je suis en 64bits.</p>
      <p>Les sources sont stockées dans un dossier commun, je ne souhaite pas qu'elles soient effacées. Pour ne pas polué ni perdre le travail effectué lors d'un <b>for i in base cli gui; do sudo  rsync -avz --delete-after rsync://downloads.nutyx.org/nutyx/8.0/x86_64/$i /srv/www/houaphan/x86_64/$i;done</b>, je préfère utiliser un dossier de travail temporaire:</p>
      <pre class="output">PKGMK_SOURCE_DIR="/srv/www/sources"
PKGMK_KEEP_SOURCES="yes"
PKGMK_WORK_DIR="/tmp/work"</pre>
      <p>Dans ce scénario, je souhaite que les dépendances soient installées mais non compilées. J'ai besoin du fichier <b>.PKGREPO</b> généré dans le dossier du port. Je souhaite pouvoir utiliser la commande <b>cards install</b> ou <b>get</b> pour pouvoir réinstaller mes binaires disponibles. La commande <b>pkgmk</b> doit donc générer le <b>.PKGREPO</b> de ma collection personnelle.</p>
      <pre class="output">PKGMK_IGNORE_REPO="no"
PKGMK_IGNORE_COLLECTION="no"</pre>
      <p>Puisque les dépendances proviennent des binaires existantes et que ces binaires sont splités. Il est préférable de conserver cette fonctionnalitée pour les paquets personnels. Les locales produites seront les 11 locales produites par défaut.</p>
      <pre class="output">PKGMK_GROUPS=(devel man doc service)
PKGMK_LOCALES=(fr de it es nl pt da nn sv fi)</pre>
      <p>Les binaires produits seront dans le même format de compression que les binaires officielles, même si ce n'est pas une obligation, on veut garder une certaine cohérence entre les binaires. Je ne souhaite pas supprimer mes binaires produits une fois installés.</p>
      <pre class="output">PKGMK_COMPRESSION_PACKAGE="yes"
PKGMK_COMPRESSION_MODE="xz"
PKGMK_CLEAN="no"</pre>
     <p>Voici à quoi peut ressembler votre fichier <b>/etc/pkgmk.conf</b> pour le scénario <b>D</b>:</p>
     <pre class="output">export CFLAGS="-O2 -pipe"
export CXXFLAGS="${CFLAGS}"
case ${PKGMK_ARCH} in
    "x86_64"|"")
       export MAKEFLAGS="-j2"
       ;;
    "i686")
       export CFLAGS="${CFLAGS} -m32"
       export CXXFLAGS="${CXXFLAGS} -m32"
       export LDFLAGS="${LDFLAGS} -m32"
       ;;
    *)
       echo "Unknown architecture selected! Exiting."
       exit 1
       ;;
esac
PKGMK_SOURCE_DIR="/srv/www/sources"
PKGMK_KEEP_SOURCES="yes"
PKGMK_WORK_DIR="/tmp/work"
PKGMK_IGNORE_REPO="no"
PKGMK_IGNORE_COLLECTION="no"
PKGMK_GROUPS=(devel man doc service)
PKGMK_LOCALES=(fr de it es nl pt da nn sv fi)
PKGMK_COMPRESSION_PACKAGE="yes"
PKGMK_COMPRESSION_MODE="xz"
PKGMK_CLEAN="no"</pre>
     <a name='246'></a>
     <h4>Conclusion</h4>
      <p>Pour ce scénario, les commandes à retenir sont:</p>
      <pre class="command"><kbd>cards level
cards base -r
cards create
for i in base cli gui;do rsync -avz --delete-after rsync://downloads.nutyx.org/nutyx/8.0/x86_64/$i \
/srv/www/houaphan/x86_64/$i;done</kbd></pre>
    <a name='25'></a>
    <h3>Scénario E</h3>
     <a name='251'></a>
     <h4>Introduction</h4>
      <p>Ce scénario est un peu l'aboutissement de mon travail. Ici on propose un mélange de différents scénarios. On installe une NuTyX dans un dossier dédié dans laquelle on produit nos paquets personnels. Cela signifie que l'on doit parler de DEUX NuTyX</p>
      <p>Ce scénario est donc la combinaison de DEUX scénario, dont un sera ... le scénario A ( <img src="../graphics/smiley-cool.gif" alt="Cool" title="Cool" /> maintenant vous savez pourquoi j'ai tenu à en parler ). Le deuxième scénario qui est celui de votre environnement isolé celui que vous préféré entre les 3 autres (B, C et D). A partir de maintenant on ne parle plus d'environnement isolée mais de la <b>chroot</b>.</p>
      <p>Quelques avantages par rapports aux précédents:</p>
      <ol>
       <li>Comme vous n'installerez jamais de paquets de developpement sur votre NuTyX principale, celle ci gardera une taille raisonnable.</li>
       <li>Bien que vous devez prévoir quelques Giga pour votre <b>chroot</b>, sachez que si vous devez la supprimer, un simple:
       <pre class="command"><kbd>rm -r /&lt;chemin-de-votre-chroot&gt;</kbd></pre> et vous retrouvez votre NuTyX principale.</li>
       <li>Tous vos paquets seront donc compilé dans la  <b>chroot</b>, ce qui épargne toute fausse manoeuvre sur votre NuTyX principale.</li>
       <li>Votre <b>chroot</b> peut être un système de base, c'est même vivement recommandé alors que sur votre principale, vous utilisez très probablement une interface graphique.</li>
      </ol>
      <p>Ma machine est une 64 bits à 4 coeurs</p>
     <a name='252'></a>
     <h4>Les fichiers /etc/cards.conf</h4>
        <u>   *** NuTyX Principale ***   </u>
        <pre class="output">
dir /chroot/usr/ports/personnel
dir /var/lib/pkg/depotrepo/gui|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/gui-extra|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/cli|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/cli-extra|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/base|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/base-extra|http://downloads.nutyx.org
locale fr
base /var/lib/pkg/depotrepo/base
base /var/lib/pkg/depotrepo/base-extra</pre>
        <p>Vous noterez que j'ai volontairement ajouter la ligne:</p>
        <pre class="output">dir /chroot/usr/ports/personnel</pre>
        <p>En effet, on veut pouvoir installer les paquets de la <b>chroot</b> dans la principale</p>
        <p>Je choisis le scenario <b>C</b> pour ma <b>chroot</b></p>
        <u>   *** NuTyX chroot     *** Scénario C ***  </u>
        <pre class="output">
dir /usr/ports/personnel
dir /usr/ports/gui
dir /usr/ports/cli
dir /usr/ports/base
dir /var/lib/pkg/depotrepo/base|http://downloads.nutyx.org
dir /var/lib/pkg/depotrepo/base-extra|http://downloads.nutyx.org
logdir /var/log/pkgbuild
locale fr
base /usr/ports/base
base /usr/ports/base-extra
base /usr/ports/aconserver</pre>
     <a name='253'></a>
     <h4>Le fichier /etc/pkgmk.conf</h4>
      <p>Comme dit plus haut, le scenario <b>A</b> n'a pas besoin de fichier de configuration <b>/etc/pkgmk.conf</b>. On peut directement configurer le <b>/etc/pkgmk.conf</b> de notre <b>chroot</b>.</p>
      <u>   *** NuTyX chroot     *** Scénario C ***  </u>
      <pre class="output">export CFLAGS="-O2 -pipe"
export CXXFLAGS="${CFLAGS}"
case ${PKGMK_ARCH} in
    "x86_64"|"")
       export MAKEFLAGS="-j4"
       ;;
    "i686")
       export CFLAGS="${CFLAGS} -m32"
       export CXXFLAGS="${CXXFLAGS} -m32"
       export LDFLAGS="${LDFLAGS} -m32"
       ;;
    *)
       echo "Unknown architecture selected! Exiting."
       exit 1
       ;;
esac
PKGMK_SOURCE_DIR="/srv/www/sources"
PKGMK_KEEP_SOURCES="yes"
PKGMK_WORK_DIR="$PWD/work"
PKGMK_IGNORE_REPO="no"
PKGMK_IGNORE_COLLECTION="no"
PKGMK_GROUPS=()
PKGMK_LOCALES=(fr)
PKGMK_COMPRESSION_PACKAGE="yes"
PKGMK_COMPRESSION_MODE="gz"
PKGMK_CLEAN="no"</pre>
     <a name='254'></a>      
     <h4>Conclusion</h4>
      <p>Dans ce scénario, (une petite piqure de rappel ne fait jamais de tord), sur la principale, ce seront les commandes:</p>
      <pre class="command"><kbd>cards install
cards install -u
cards remove</kbd></pre>
      <p>et dans la <b>chroot</b>, on utilisera:</p>
      <pre class="command"><kbd>cards depcreate
cards level
cards base -r</kbd></pre>
      <p><a href="#6">Nous voilà paré, pour créer, compiler et installer un paquet dans un environnement isolé</a></p>
  <a name='4'></a>
  <h2>Scénario B: un paquet sans dépendances</h2>
   <div class="important"><img src="../graphics/caution.gif" width="10" height="10" alt="!!!" /> A partir de cet instant toutes les commandes que vous allez effectuer DOIVENT se faire via le compte root (administrateur). Soyez très attentif lorsque vous tapez les commandes.</div>
   <p>Commençons donc par basculer en <b><span style="color: #ff0000;">compte root</span></b></p>
   <pre class="command_user"><kbd>su -</kbd></pre>
   <pre class="output">Password:</pre>
   <p>J'espère que vous vous rappelez du mot de passe <img src="../graphics/smiley-cool.gif" alt="Cool" title="Cool" />. Notez bien <b>le tiret</b>, il est indispensable pour que vous exécutiez les fichiers de configuration du compte root.</p>
   <p>Nous voilà donc en root, (la couleur du prompt est passée en rouge)</p>
   <p>Si vous lisez ceci, assurez-vous d'avoir effectué toutes les manipulations pour le scénario concerné, <a href="#22">dans notre exemple il s'agit du scénario <b>B</b></a>.</p>
   <p>Je vous propose de construire le petit editeur de texte JOE. Vous me direz, il existe déjà, peu importe, l'idée ici est de se faire la main sur un paquet simple.</p>
   <p>Pour qu'une recette se compile et s'installe correctement il est important de donner au nom du dossier de la recette, le même nom que celui défini par la variable name. Dans notre cas, le nom est: <b>joe</b></p>
   <a name='41'></a>
   <h3>Création du dossier</h3>
    <pre class="command"><kbd>mkdir -p /usr/ports/personnel/joe</kbd></pre>
   <a name='42'></a>
   <h3>Création de la recette</h3>
    <p>Si je me base sur la recette de <a href="http://www.linuxfromscratch.org/blfs/view/svn/postlfs/joe.html" title="Lire dans une autre fenêtre" class="external" onclick="window.open(this.href); return false;">BLFS</a>, tapez donc ce texte dans votre terminal et DANS votre chroot <img src="../graphics/smiley-laughing.gif" alt="Laughing" title="Laughing" /></p>
    <pre class="command"><kbd>cat &gt; /usr/ports/personnel/joe/Pkgfile &lt;&lt; "EOF"
# Description: Petit éditeur non graphique emulant emuler, wordStar
# URL: http://joe-editor.sourceforge.net/
# Maintainer: JHallen, JJJordan, Marx_sk, shallot
# Packager: François Perrin

name=joe
version=3.7
release=1
source=( <a href="http://downloads.sourceforge.net/joe-editor/joe-3.7.tar.gz">http://downloads.sourceforge.net/$name-editor/$name-$version.tar.gz)</a>
build() {
  cd $name-$version
  ./configure --prefix=/usr --sysconfdir=/etc
  make
  make DESTDIR=$PKG install
}
EOF</kbd></pre>
   <a name='43'></a>
   <h3>Compilation de la recette</h3>
    <p>Ca y est tout est en place pour la compilation de notre nouveau paquet... Oui je l'ai déjà dis celle-là <img src="../graphics/yippee.gif" alt="yippee"/></p>
    <pre class="command"><kbd>cd /usr/ports/personnel/joe
pkgmk -d</kbd></pre>

    <pre class="output">=======> PKGMK_INSTALL: no
=======> PKGMK_WORK_DIR: /usr/ports/personnel/joe/work
=======> PKGMK_SOURCE_DIR: /usr/ports/personnel/joe
=======> WARNING: CLEAN IGNORED
=======> WARNING: KEEP SOURCES
=======> PKGMK_UPDATE_SIGNATURE:
=======> PKGMK_IGNORE_FOOTPRINT: yes
=======> PKGMK_IGNORE_MD5SUM: yes
=======> .PKGREPO file will not be generated
=======> PKGMK_COMPRESS_PACKAGE: no
=======> name: joe
=======> version: 3.7
=======> Downloading 'http://downloads.sourceforge.net/joe-editor/joe-3.7.tar.gz'.
...
...
Saving to: '/usr/ports/personnel/joe/joe-3.7.tar.gz.partial'
2014-10-26 22:27:47 (1.01 MB/s) - '/usr/ports/personnel/joe/joe-3.7.tar.gz.partial' saved [696036/696036]

=======> Building '/usr/ports/personnel/joe/joe1414362465x86_64.cards.tar.xz'.
bsdtar -p -o -C /usr/ports/personnel/joe/work/src -xf /usr/ports/personnel/joe/joe-3.7.tar.gz
+ build
+ cd joe-3.7
+ ./configure --prefix=/usr --sysconfdir=/etc
...
...
make[3]: Leaving directory '/usr/ports/personnel/joe/work/src/joe-3.7'
make[2]: Leaving directory '/usr/ports/personnel/joe/work/src/joe-3.7'
make[1]: Leaving directory '/usr/ports/personnel/joe/work/src/joe-3.7'
=======> WARNING: Footprint ignored.</pre>

   <a name='44'></a>
   <h3>Installer mon paquet</h3>
    <p>Pour installer notre paquet, il suffit de taper la commande:</p>
    <pre class="command"><kbd>pkgadd joe1414362465x86_64.cards.tar</kbd></pre>
  <a name='5'></a>
  <h2>Un paquet avec quelques dépendances</h2>
   <p>Si vous lisez ceci, assurez-vous d'avoir effectué toutes les manipulations pour le scénario concerné, <a href="#23">dans notre exemple il s'agit su scénario <b>C</b></a>.</p>
   <p>Les dépendances d'un paquet sont souvent le casse tête d'un empaqueteur. Il est en effet jamais facile de connaître exactement quelles sont les dépendances indispensables pour que le paquet en chantier se compile sans problème.</p>
   <p>En plus des dépendances indispensables, il y a aussi les dépendance optionnelles qui permettent d'avoir plus de fonctionnalitées. Par principe, sous NuTyX nous essayons de proposer le maximum de fonctionalitées.</p>
   <p>Le paquet que nous allons construire n'apportera certainement pas grand chose à votre NuTyX.  C'est surtout la methode utilisée qui nous intéresse ici: Nous allons donc prendre le paquet <b>clipit</b> qui d'après le README est (en anglais dans le texte)</p>
   <p><i>ClipIt is a lightweight GTK+ clipboard manager.</i></p>
   <p><i>Project website: http://clipit.rspwn.com/</i></p>
   <p><i>Requirements:</i></p>
   <p><i>* gtk+ >= 2.10.0</i></p>
   <div class="important"><img src="../graphics/caution.gif" width="10" height="10" alt="!!!" /> A partir d'ici, nous sommes dans la <b>chroot</b></div>
   <ol>
    <a name='51'></a>
    <li><h3>Créer le dossier</h3>
     <pre class="command"><kbd>mkdir -p /usr/ports/personnel/clipit</kbd></pre>
     </li>
    <a name='52'></a>
    <li><h3>Créer le fichier Pkgfile</h3>
    <p>Completez le fichier <b>/usr/ports/personnel/clipit/Pkgfile</b>  avec ceci:</p>
    </li>
    <pre class="command"><kbd># Description: ClipIt is a lightweight GTK+ clipboard manager.
# URL: http://clipit.rspwn.com/
# Maintainer: Gilberto Xyhthyx &lt;xyhthyx at gmail dot com&gt;
# Packager: François Perrin
# Depends on: gtk

name=clipit
version=1.4.2
release=1
source=(https://github.com/downloads/shantzu/ClipIt/$name-$version.tar.gz)
build() {
  cd $name-$version
  ./configure --prefix=/usr \
  --sysconfdir=/etc
  make
  make DESTDIR=$PKG install
}</kbd></pre>
   <a name='53'></a>
   <li><h3>Compilez le paquet.</h3>
    <pre class="command"><kbd>cards depcreate clipit</kbd></pre>
    <p>La commande <b>cards depcreate</b> compile les dépendances, installe les dépendances, compile le paquet final et l'installe.</p></li>
    <div><img src="../graphics/yippee.gif" alt="yippee"/> C'est magique <img src="../graphics/yippee.gif" alt="yippee"/></div>
   </ol>
  <a name='6'></a>
  <h2>Methode de construction dans un environnement isolé aussi appelé "chroot"</h2>
   <p>Cette methode n'est pas indispensable mais fortement recommandée.</p>
   <p>Elle permet en effet d'éviter de "casser" la NuTyX qu'on utilise tous les jours. Dans un environnement isolé, vous vous assurez de préserver votre NuTyX principale contre toute fausse manoeuvre.</p>
   <p>On appellera désormais notre environnement isolé: <b> chroot</b>.<p>
   <p>On va commencer par récupérer les bon scripts:</p>
   <pre class="command"><kbd>wget http://downloads.nutyx.org/install-houaphan{,.md5sum}
md5sum -c install-houaphan.md5sum</kbd></pre>
   <pre class="output">install-houaphan: Réussi</pre>
   <p>Nous allons définir une fois pour toute la variable LFS, elle définiera le dossier dans lequel sera installée <b>la chroot</b>:</p>
   <p>Comme je suis un grand original, je vous propose de choisir le dossier ...<b>/chroot</b> comme dossier de destination, la commande est donc:</p>
   <pre class="command"><kbd>export LFS=/chroot</kbd></pre>
   <p>On peut maintenant lancer l'installation sans grosse crainte</p>
   <pre class="command"><kbd>bash install-houaphan</kbd></pre>
   <p>Et l'installation commence.</p>
   <pre class="output">This installation will be on /chroot                                     [ INFO ]
*******************************************
downloads of cards.devel1412543016x86_64.cards.tar.xz

.....
...
ADD: cards-0.10.81.3, 9 files: 100 %                                     [  OK  ]
Downloading ca-certificates...                                           [ INFO ]
Retrieve info about the 62 packages: 100 %
pre-install: start
pre-install: finish
ADD: ca-certificates-20141001, 323 files: 100 %                          [  OK  ]
"***************************************************"
"* Installation finish. Tanks for installing NuTyX *"
"*                                                 *"
"* Dont forget to choose a valid kernel before you *"
"*      want to boot on your install NuTyX         *"
"*                                                 *"
"*        For more info, come to visit us:         *"
"*                                                 *"
"*              http://www.nutyx.org               *"
"*                                                 *"
"***************************************************"</pre>
   <p>Pour pouvoir travailler dans la chroot il est necessaire de pouvoir rentrer (et sortir) facilement de l'environnement, pour ce faire, nous allons utiliser le même script. Vous êtes toujours en root tapez donc ceci dans votre terminal:</p>
   <pre class="command"><kbd>bash install-houaphan -ec</kbd></pre>
   <p>Ce script vous permet donc également d'entrer et de sortir très simplement de votre chroot.</p>
   <div class="important"><img src="../graphics/caution.gif" width="10" height="10" alt="!!!" />Désormais pour entrer dans votre chroot, utilisez UNIQUEMENT la commande en root:</div>
   <pre class="command"><kbd>bash install-houaphan -ec</kbd></pre>
   <p>Le gros avantage de travailler dans une chroot est que si vous faîtes une manipulation douteuse et comme vous êtes en root, ce ne sera jamais très grave.</p>
   <div class="important"><img src="../graphics/caution.gif" width="10" height="10" alt="!!!" /> En revanche si vous n'êtes pas dans la chroot, et que vous tapez certaines commandes mentionnée dans cet article, je ne peux pas vous garantir le résultat et donc le fonctionnement de votre NuTyX.</div>
   <div><img src="../graphics/yippee.gif" alt="yippee" />Tout est en place, on peut maintenant construire un <a href="#5">un paquet avec quelques dépendances</a>.</div>
   <div><img src="../graphics/clap.gif" alt="clap" />Ca c'est vraiment cool non <img src="../graphics/clap.gif" alt="clap" /></div>
   <p>Votre premier paquet est compilé et installé. Le gestionnaire de paquet (de votre chroot) l'a intégré dans sa base de données. Petite remarque, si vous avez suivi ce tuto, vous avez sans doute remarquez que toutes les commandes ont été effectuées depuis la racine de votre chroot ... <img src="../graphics/smiley-cool.gif" alt="Cool" title="Cool" />.</p>
   <p>Tapez maintenant la commande suivante:</p>
   <pre class="command"><kbd>cards info clipit</kbd></pre>
   <pre class="output">Retrieve info about the 123 packages: 100 %
Name           : clipit
Description    : ClipIt is a lightweight GTK+ clipboard manager.
Maintainer     : Gilberto Xyhthyx &lt;xyhthyx at gmail dot com&gt;
Packager       : François Perrin
Version        : 1.4.2
Release        : 1
Build date     : Sun Oct 26 22:27:45 2014
Size           : 1117696
Number of Files: 70
Arch           : x86_64</pre>
   <a name='61'></a>
   <h3>Installer mon premier paquet sur la NuTyX principale</h3>
    <div><img src="../graphics/wall.gif" alt="wall" /> Super j'ai un nouveau paquet...</div><br />
    <div><img src="../graphics/question.gif" width="16" height="15" alt="?" /> Mais comment je fais pour l'installer dans ma NuTyX principale... ?</div><br />
    <div><img src="../graphics/answer.gif" width="15" height="15" alt="!!" /> Pas de problème tout est prévu.</div><br />
    <p>On peut maintenant quitter la chroot:</p>
    <pre class="command"><kbd>exit</kbd></pre>
    <div class="important"><img src="../graphics/caution.gif" width="10" height="10" alt="!!!" /> A partir d'ici, vous êtes de nouveau dans votre NuTyX principale</div>
    <p>Donc si vous faites maintenant:</p>
    <pre class="command"><kbd>cards info -b clipit</kbd></pre>
    <pre class="output">Name           : clipit
Description    : ClipIt is a lightweight GTK+ clipboard manager.
Maintainer     : Gilberto Xyhthyx &lt;xyhthyx at gmail dot com&gt;
Packager       : François Perrin
Version        : 1.4.2
Release        : 1
Build date     : Sun Oct 26 23:27:45 2014
Arch           : x86_64
Url            :
Local Directory: /chroot/usr/ports/personnel</pre>
    <div><img src="../graphics/smiley-cool.gif" alt="Cool" title="Cool" /><img src="../graphics/smiley-cool.gif" alt="Cool" title="Cool" /><img src="../graphics/smiley-cool.gif" alt="Cool" title="Cool" /></div>
    <p>Il ne nous reste plus qu'à l'installer <img src="../graphics/smiley-surprised.gif" alt="Surprised" title="Surprised" /></p>
    <pre class="command_user"><kbd>get clipit</kbd></pre>
    <pre class="output">Retrieve info about the 622 packages: 100 %
ADD: clipit-1.4.2, 71 files: 100 %</pre>
   <hr>
  <p class="updated">Dernière mise à jour 19-12-2015 22:13</p>
     <footer>
        <p id="foot">... <img src="../graphics/logo_nutyx_25.png" alt="nutyx petit logo"> ...<br />
        &copy; 2007 - 2015 <a href="http://nutyx.org">NuTyX</a><br /><br />
    <a href="http://www.wtfpl.net/"><img
       src="http://www.wtfpl.net/wp-content/uploads/2012/12/wtfpl-badge-4.png"
       width="80" height="15" alt="WTFPL" /></a></p>
    </footer>
 </body>
</html>
